# 实验6 基于神经网络的人脸检测 (MTCNN)

- 做了啥：基于 MTCNN 架构实现了人脸检测。搭建了 PNet、RNet、ONet 三级级联网络。PNet 负责快速生成候选框，RNet 进行筛选，ONet 进行精细回归和关键点定位。使用了 WIDER Face 数据集进行训练，实现了多任务损失函数（分类+边框+关键点），并测试了模型在复杂场景下的表现。
- 遇到的问题：数据预处理比较繁琐，特别是生成 RNet 和 ONet 的训练数据时，需要用上一级网络的输出裁剪图片，容易爆内存；多任务损失函数的权重调节比较微妙；训练时间较长，参数调试（如 batch size）受限于显存大小。
- 解决方案：在生成训练数据时，适当减少了采样数量或分批处理，避免一次性加载过多数据导致 OOM；参考了论文和开源代码设置损失权重；调小 batch size，并没有跑完所有的 epoch，而是重点观察了 loss 的下降趋势和中间结果；使用了 TensorBoard 监控训练过程。
- 启发：级联结构（Cascade）非常巧妙，由粗到细（Coarse-to-Fine）逐步过滤，既保证了速度又提升了精度；多任务学习（Multi-task Learning）能让网络同时学到多种特征，辅助任务（如关键点）能帮助主任务（人脸框）定位更准；深度学习落地不仅看模型结构，数据工程（预处理、难例挖掘）也非常关键。
